# Waterproof Tutorial

Try to solve the exercises below by inspecting the examples. Not sure how to start? You can type **Ctrl + space** or **Command + space** to get a list of possible options.<hint title="üì¶ Import libraries (click to open/close)">
```coq
From Stdlib Require Import Rbase.
From Stdlib Require Import Rfunctions.

Require Import Waterproof.Waterproof.
Require Import Waterproof.Notations.Common.
Require Import Waterproof.Notations.Reals.
Require Import Waterproof.Notations.Sets.
Require Import Waterproof.Chains.
Require Import Waterproof.Tactics.
Require Import Waterproof.Libs.Analysis.SupAndInf.
Require Import Waterproof.Automation.

Waterproof Enable Automation RealsAndIntegers.


Open Scope R_scope.
Open Scope subset_scope.
Set Default Goal Selector "!".

Set Bullet Behavior "Waterproof Relaxed Subproofs".


Notation "'max(' x , y )" := (Rmax x y)
  (format "'max(' x ,  y ')'").
Notation "'min(' x , y )" := (Rmin x y)
  (format "'min(' x ,  y ')'").
```
</hint>## 1. We conclude that

### Example:
```coq
Lemma example_reflexivity :
  0 = 0.
Proof.
Help. (* optional, ask for help, remove from final proof *)
We conclude that 0 = 0.
Qed.
```
## 2. We need to show that
Sometimes it is useful to remind the reader or yourself of what you need to show.
### Example
```coq
Lemma example_we_need_to_show_that :
  2 = 2.
Proof.
We need to show that 2 = 2.
We conclude that 2 = 2.
Qed.
```
## 3. Show for-all statements: take arbitrary values

### Example:
```coq
Lemma example_take :
  ‚àÄ x ‚àà ‚Ñù,
    x = x.
Proof.
Take x ‚àà ‚Ñù.
We conclude that x = x.
Qed.
```
## 4. Show there-exists statements: choose values
### Example
```coq
Lemma example_choose :
  ‚àÉ y ‚àà ‚Ñù,
    y < 3.
Proof.
Choose y := 2.
{ Indeed, y ‚àà ‚Ñù. } (* Note: there needs to be a space between '.' and '}' *)
We conclude that y < 3.
Qed.
```
## 5. Combine for-all and there-exists statements
### Example
```coq
Lemma example_combine_quantifiers :
  ‚àÄ a ‚àà ‚Ñù,
    ‚àÄ b > 5,
      ‚àÉ c ‚àà ‚Ñù,
        c > b - a.
Proof.
Take a ‚àà ‚Ñù.
Take b > 5.
Choose c := b - a + 1.
{ Indeed, c ‚àà ‚Ñù. }
We conclude that c > b - a.
Qed.
```
## 6.  Make an assumption
### Example
```coq
Lemma example_assumptions :
  ‚àÄ a ‚àà ‚Ñù,
    a < 0 ‚áí - a > 0.
Proof.
Take a ‚àà ‚Ñù.
Assume that a < 0.
We conclude that - a > 0.
Qed.
```
### Another example with explicit labels
```coq
Lemma example_assumptions_2 :
  ‚àÄ a ‚àà ‚Ñù,
    a < 0 ‚áí - a > 0.
Proof.
Take a ‚àà ‚Ñù.
Assume that a < 0 as (i). (* The label here is optional *)
By (i) we conclude that - a > 0.
Qed.
```
## 7. Chains of (in)equalities
### Example
```coq
Section monotone_function.
Variable f : ‚Ñù ‚Üí ‚Ñù.
Parameter f_increasing : ‚àÄ x ‚àà ‚Ñù, ‚àÄ y ‚àà ‚Ñù, x ‚â§ y ‚áí f(x) ‚â§ f(y).

Lemma example_inequalities:
  2 < f(0) ‚áí 2 < f(1).
Proof.
Assume that 2 < f(0).
By f_increasing we conclude that & 2 < f(0) ‚â§ f(1).
Qed.
```
## 8. Backwards reasoning in smaller steps

### Example
```coq
Lemma example_backwards :
  3 < f(0) ‚áí 2 < f(5).
Proof.
Assume that 3 < f(0).
It suffices to show that f(0) ‚â§ f(5).
By f_increasing we conclude that f(0) ‚â§ f(5).
Qed.
```
## 9. Forwards reasoning in smaller steps
### Example
```coq
Lemma example_forwards :
  7 < f(-1) ‚áí 2 < f(6).
Proof.
Assume that 7 < f(-1).
By f_increasing it holds that f(-1) ‚â§ f(6).
We conclude that 2 < f(6).
Qed.
```

```coq
End monotone_function.
```
## 10. Use a *for-all* statement
### Example
```coq
Lemma example_use_for_all :
  ‚àÄ x ‚àà ‚Ñù,
    (‚àÄ Œµ > 0, x < Œµ) ‚áí
       x + 1/2 < 1.
Proof.
Take x ‚àà ‚Ñù.
Assume that ‚àÄ Œµ > 0, x < Œµ as (i).
Use Œµ := 1/2 in (i).
{ Indeed, 1 / 2 > 0. }
It holds that  x < 1 / 2.
We conclude that x + 1/2 < 1.
Qed.
```
## 11. Use a *there-exists* statement
### Example
```coq
Lemma example_use_there_exists :
  ‚àÄ x ‚àà ‚Ñù,
    (‚àÉ y > 10, y < x) ‚áí
      10 < x.
Proof.
Take x ‚àà ‚Ñù.
Assume that ‚àÉ y > 10, y < x as (i).
Obtain such a y.
We conclude that & 10 < y < x.
Qed.
```
### Another example
```coq
Lemma example_use_there_exists_2 :
  ‚àÄ x ‚àà ‚Ñù,
    (‚àÉ y > 14, y < x) ‚áí
      12 < x.
Proof.
Take x ‚àà ‚Ñù.
Assume that ‚àÉ y > 14, y < x as (i).
Obtain y according to (i).
We conclude that & 12 < y < x.
Qed.
```
## 12. Argue by contradiction
### Example
```coq
Lemma example_contradicition :
  ‚àÄ x ‚àà ‚Ñù,
    (‚àÄ Œµ > 0, x > 1 - Œµ) ‚áí
      x ‚â• 1.
Proof.
Take x ‚àà ‚Ñù.
Assume that ‚àÄ Œµ > 0, x > 1 - Œµ as (i).
We need to show that x ‚â• 1.
We argue by contradiction.
Assume that ¬¨ (x ‚â• 1).
It holds that (1 - x) > 0.
By (i) it holds that x > 1 - (1 - x).
Contradiction.
Qed.
```
## 13. Split into cases
### Example
```coq
Lemma example_cases :
  ‚àÄ x ‚àà ‚Ñù, ‚àÄ y ‚àà ‚Ñù,
    max(x, y) = x ‚à® max(x, y) = y.
Proof.
```

```coq
Take x ‚àà (‚Ñù).
Take y ‚àà (‚Ñù).
Either x < y or x ‚â• y.
- Case x < y.
  It suffices to show that max(x, y) = y.
  We conclude that max(x, y) = y.
- Case x ‚â• y.
  It suffices to show that max(x, y) = x.
  We conclude that max(x, y) = x.
Qed.
```
## 14. Prove two statements: A ‚àß B
### Example
```coq
Lemma example_both_statements :
  ‚àÄ x ‚àà ‚Ñù, x^2 ‚â• 0 ‚àß | x | ‚â• 0.
Proof.
Take x ‚àà ‚Ñù.
We show both statements.
* We need to show that x^2 ‚â• 0.
  We conclude that x^2 ‚â• 0.
* We need to show that | x | ‚â• 0.
  We conclude that | x | ‚â•  0.
Qed.
```
## 15. Show both directions
### Example
```coq
Lemma example_both_directions :
  ‚àÄ x ‚àà ‚Ñù, ‚àÄ y ‚àà ‚Ñù,
    x < y ‚áî y > x.
Proof.
Take x ‚àà ‚Ñù.
Take y ‚àà ‚Ñù.
We show both directions.
++ We need to show that x < y ‚áí y > x.
   Assume that x < y.
   We conclude that y > x.
++ We need to show that y > x ‚áí x < y.
   Assume that y > x.
   We conclude that x < y.
Qed.
```
## 16. Proof by induction
### Example
```coq
Lemma example_induction :
  ‚àÄ n : ‚Ñï ‚Üí ‚Ñï, (‚àÄ k ‚àà ‚Ñï, (n(k) < n(k+1))%nat) ‚áí
    ‚àÄ k ‚àà ‚Ñï, (k ‚â§ n(k))%nat.
Proof.
Take n : ‚Ñï ‚Üí ‚Ñï.
Assume that (‚àÄ k ‚àà ‚Ñï, n(k) < n(k+1))%nat.
We use induction on k.
+ We first show the base case (0 ‚â§ n(0))%nat.
  We conclude that (0 ‚â§ n(0))%nat.
+ We now show the induction step.
  Take k ‚àà ‚Ñï.
  Assume that (k ‚â§ n(k))%nat.
  It holds that (n(k) < n(k+1))%nat.
  It holds that (n(k) + 1 ‚â§ n(k+1))%nat.
  We conclude that (& k + 1 ‚â§ n(k) + 1 ‚â§ n(k + 1))%nat.
Qed.
```
## 17. Expand definitions

We will now explain how to use definitions.

### Example

Here's, as an example, the definition of the square function.
```coq
Definition square (x : ‚Ñù) := x^2.
```
<hint title="üîß Technical details (click to open/close)">
```coq
Waterproof Register Expand "square";
  for square;
  as "Definition square".
```
</hint>

By writing `Expand square.` you get suggestions on how to use the definition of _square_ in your proof.
Alternatively, you can just write `Expand All.` and you get suggestions for all definitions that
Waterproof knows about.

After writing one of these, you can click on the button `replace` to replace the line
`Expand square.` or `Expand All.` with one of the suggested statements.

```coq
Lemma example_expand :
  ‚àÄ x ‚àà ‚Ñù, square x ‚â• 0.
Proof.
Take x ‚àà (‚Ñù).
Expand square.
  (* Remove the above line in your own code! *)
Expand All.
  (* Remove the above line in your own code! *)
We need to show that x^2 ‚â• 0.
We conclude that x^2 ‚â• 0.
Qed.
```
